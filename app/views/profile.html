<html>
  <head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"></link>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>

    <style>
      .app {
        margin: 0px;
      }
      .chatWindow {
        height: 520px;
        border: 2px solid grey;
        padding: 0px;
      }
      .chatInfo {
        width: 100%;
        height: 50px;
        border: 2px solid grey;
      }
      .chats {
        width: 100%;
        height: 400px;
        max-height: 400px;
        border: 2px solid grey;
        overflow-y: auto;
      }
      #chatBox {
        width: 100%;
        height: 70px;
      }
      .friendListWindow {
        height: 500px;
        border: 2px solid grey;
        padding: 0px;
      }
      .info {
        width: 100%;
        height: 50px;
        border: 2px solid grey;
      }
      .userList {
        overflow-y: auto;
        max-height: 470px;
      }
      .options {
        width: 400px;
        height: 50px;
        float: right;
        margin-right: 50px;
        display: flex;
      }
      .notification {
        width: 30px;
        float:left;
        margin-left: 120px;
        margin-top: 7px;
      }
      .notificationIcon {
        width: 30px;
        height: 30px;
      }
      .friendsSearch {
      }
      .profileOptions {
        margin-top: 8px;
      }
      #profileMenuButton {
        border-radius: 100%;
      }
      .profileOptions .caret {
        display: none;
      }
      .results {
        style: none
      }
    </style>
  </head>

  <script>

    $(document).ready(function() {

      initializeSockets();

      $('#key').keyup(function() {
        $.ajax({
          type: "GET",
          url: 'http://localhost:8081/search_users',
          data: {
              key: $('#key').val()
          },
          success: function(results) {
            $(".results").empty();
            results.forEach(function(result) {
              var elem = "<li><a href='http://localhost:8081/users/" + result.id + "'>" + result.name + "</a></li>";;
              $(".results").append(elem);
            });
          }
        });
      });

      $('#logOut').click(function() {
        $("#logOutForm").submit();
      });
      
    });

    function initializeSockets() {
      var socket = io.connect();
      var user_id = "{{ user._id }}";
      socket.on(user_id, function(data) {
        debugger;
      });

    }

  </script>

  <body>
    <div class="container-fluid app">
      <div class="topBar">
        <div class="siteName">
          <a class="navbar-brand" href="#">WebSiteName</a>
        </div>
        <div class="options">
          <div class="notification">
            <img src="notification.png" class="notificationIcon"></img>
          </div>
          <div class="friendsSearch">
            <form class="navbar-form navbar-left">
              <div class="form-group">
                <div class="dropdown">
                  <input type="text" class="form-control" id="key" name="key" placeholder="Search">
                  <ul class="results">
            		 </ul>
                </div>
              </div>
            </form>
          </div>
          <div class="profileOptions">
            <div class="dropdown">
              <button class="btn btn-default dropdown-toggle" id="profileMenuButton" type="button" data-toggle="dropdown">{{ user.name.charAt(0) }}
              <span class="caret"></span></button>
              <ul class="dropdown-menu" style="right: 0; left: auto;">
                <li><a href="#">Logged in as: {{ user.name }}</a></li>
                <li><a href="#" id="logOut">Log out</a></li>
              </ul>
              <form action="http://localhost:8081/logout" method="post" id="logOutForm">
              </form>
            </div>
          </div>
        </div>
      </div>
      </div>
      <div class="row">
        <div class="friendListWindow col-md-3">
          <div class="info">
          </div>
          <div class="userList">
            <ul class="list-group">
              <li class="list-group-item">First item</li>
              <li class="list-group-item">Second item</li>
              <li class="list-group-item">Third item</li>
              <li class="list-group-item">First item</li>
              <li class="list-group-item">Second item</li>
              <li class="list-group-item">Third item</li>
              <li class="list-group-item">First item</li>
              <li class="list-group-item">Second item</li>
              <li class="list-group-item">Third item</li>
              <li class="list-group-item">First item</li>
              <li class="list-group-item">Second item</li>
              <li class="list-group-item">Third item</li>
              <li class="list-group-item">First item</li>
              <li class="list-group-item">Second item</li>
              <li class="list-group-item">Third item</li>
            </ul>
          </div>
        </div>

        <div class="chatWindow col-md-9">
          <div class="chatInfo">
          </div>
          <div class="chats">
          </div>
          <div class="chatForm">
            <form>
              <textarea id="chatBox"></textarea>
            </form>
          </div>
        </div>

      </div>
    </div>
  </body>
</html>
